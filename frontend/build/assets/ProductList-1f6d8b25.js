import{r as v,H as q,E as S,a7 as T,a8 as D,_ as Q,b as B,c as R,o as V,e as U,i as x,f as a,w as n,I as A,t as I,A as j,n as g,J as F,k as N,z as L,q as G,s as H,V as J,W as K,g as O,D as W,F as X,G as Y,K as Z,L as $}from"./index-518491b2.js";/* empty css                   *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                *//* empty css                     */import{g as ee,d as te}from"./product-50d99a21.js";function ae(m,e={}){const{immediate:b=!1,params:t={page:1,limit:10},showSuccessMessage:w=!1,showErrorMessage:E=!0,successMessage:i="获取列表成功",errorMessage:c="获取列表失败",onSuccess:u=null,onError:r=null}=e,p=v(!1),f=v([]),d=v(0),o=v(t.page||1),h=v(t.limit||10),P=v(null),_=async(y=null)=>{p.value=!0,P.value=null;try{const M={...t,...y},s=await m(M),C=q(s);return f.value=C.data,d.value=C.total,o.value=C.page,h.value=C.limit,w&&S.success(i),u&&u(C),C}catch(M){const s=T(M);return P.value=s,E&&S.error(s.message||c),r&&r(s),Promise.reject(s)}finally{p.value=!1}},z=y=>{o.value=y,_({page:y,limit:h.value})},l=y=>{h.value=y,o.value=1,_({page:1,limit:y})},k=()=>{_({page:o.value,limit:h.value})};return b&&_(),{loading:p,list:f,total:d,page:o,limit:h,error:P,fetchList:_,handlePageChange:z,handleLimitChange:l,refresh:k}}function le(m,e={}){const{showSuccessMessage:b=!0,showErrorMessage:t=!0,successMessage:w="操作成功",errorMessage:E="操作失败",onSuccess:i=null,onError:c=null}=e,u=v(!1),r=v(null);return{loading:u,error:r,submit:async f=>{u.value=!0,r.value=null;try{const d=await m(f);if(b){const o=D(d);S.success(o.message||w)}return i&&i(d),d}catch(d){const o=T(d);return r.value=o,t&&S.error(o.message||E),c&&c(o),Promise.reject(o)}finally{u.value=!1}}}}const ne={name:"ProductList",setup(){const m=B(),e=R({name:"",type:"",status:"",page:1,limit:10}),{loading:b,list:t,total:w,page:E,limit:i,fetchList:c,handlePageChange:u,handleLimitChange:r}=ae(ee,{immediate:!0,params:e,errorMessage:"获取产品列表失败"}),{submit:p,loading:f}=le(te,{successMessage:"删除成功",errorMessage:"删除失败",onSuccess:()=>c()});return{queryParams:e,loading:b,list:t,total:w,page:E,limit:i,deleteLoading:f,getProductTypeText:s=>({tour:"旅游产品",hotel:"酒店",flight:"机票",other:"其他"})[s]||"未知",handleQuery:()=>{e.page=1,c(e)},resetQuery:()=>{e.name="",e.type="",e.status="",e.page=1,c(e)},handleCurrentChange:s=>{u(s)},handleSizeChange:s=>{r(s)},handleCreate:()=>{m.push("/product/create")},handleEdit:s=>{m.push(`/product/edit/${s.id}`)},handleDetail:s=>{m.push(`/product/detail/${s.id}`)},handleQuotes:s=>{m.push(`/product/quotes/${s.id}`)},handleDelete:s=>{A.confirm("确认删除该产品吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{p(s.id)}).catch(()=>{})}}}},oe={class:"product-list-container"},se={class:"product-list-header"},re={class:"pagination-container"};function ie(m,e,b,t,w,E){const i=I,c=G,u=H,r=J,p=K,f=O,d=j,o=W,h=X,P=Y,_=Z,z=$;return V(),U("div",oe,[x("div",se,[e[6]||(e[6]=x("h2",null,"产品管理",-1)),a(i,{type:"primary",onClick:t.handleCreate},{default:n(()=>e[5]||(e[5]=[g("新增产品")])),_:1},8,["onClick"])]),a(d,{class:"filter-container"},{default:n(()=>[a(f,{inline:!0,model:t.queryParams,class:"demo-form-inline"},{default:n(()=>[a(u,{label:"产品名称"},{default:n(()=>[a(c,{modelValue:t.queryParams.name,"onUpdate:modelValue":e[0]||(e[0]=l=>t.queryParams.name=l),placeholder:"请输入产品名称",clearable:""},null,8,["modelValue"])]),_:1}),a(u,{label:"产品类型"},{default:n(()=>[a(p,{modelValue:t.queryParams.type,"onUpdate:modelValue":e[1]||(e[1]=l=>t.queryParams.type=l),placeholder:"请选择产品类型",clearable:""},{default:n(()=>[a(r,{label:"旅游产品",value:"tour"}),a(r,{label:"酒店",value:"hotel"}),a(r,{label:"机票",value:"flight"}),a(r,{label:"其他",value:"other"})]),_:1},8,["modelValue"])]),_:1}),a(u,{label:"状态"},{default:n(()=>[a(p,{modelValue:t.queryParams.status,"onUpdate:modelValue":e[2]||(e[2]=l=>t.queryParams.status=l),placeholder:"请选择状态",clearable:""},{default:n(()=>[a(r,{label:"上架",value:"active"}),a(r,{label:"下架",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),a(u,null,{default:n(()=>[a(i,{type:"primary",onClick:t.handleQuery},{default:n(()=>e[7]||(e[7]=[g("查询")])),_:1},8,["onClick"]),a(i,{onClick:t.resetQuery},{default:n(()=>e[8]||(e[8]=[g("重置")])),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1}),a(d,{class:"table-container"},{default:n(()=>[F((V(),N(P,{data:t.list,border:"",style:{width:"100%"}},{default:n(()=>[a(o,{prop:"name",label:"产品名称",width:"180"}),a(o,{prop:"type",label:"产品类型",width:"120"},{default:n(l=>[g(L(t.getProductTypeText(l.row.type)),1)]),_:1}),a(o,{prop:"description",label:"产品描述","show-overflow-tooltip":""}),a(o,{prop:"status",label:"状态",width:"100"},{default:n(l=>[a(h,{type:l.row.status==="active"?"success":"info"},{default:n(()=>[g(L(l.row.status==="active"?"上架":"下架"),1)]),_:2},1032,["type"])]),_:1}),a(o,{prop:"createdAt",label:"创建时间",width:"180"}),a(o,{label:"操作",width:"250"},{default:n(l=>[a(i,{size:"small",type:"primary",onClick:k=>t.handleEdit(l.row)},{default:n(()=>e[9]||(e[9]=[g("编辑")])),_:2},1032,["onClick"]),a(i,{size:"small",type:"success",onClick:k=>t.handleDetail(l.row)},{default:n(()=>e[10]||(e[10]=[g("详情")])),_:2},1032,["onClick"]),a(i,{size:"small",type:"warning",onClick:k=>t.handleQuotes(l.row)},{default:n(()=>e[11]||(e[11]=[g("报价")])),_:2},1032,["onClick"]),a(i,{size:"small",type:"danger",onClick:k=>t.handleDelete(l.row)},{default:n(()=>e[12]||(e[12]=[g("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[z,t.loading]]),x("div",re,[a(_,{"current-page":t.page,"onUpdate:currentPage":e[3]||(e[3]=l=>t.page=l),"page-size":t.limit,"onUpdate:pageSize":e[4]||(e[4]=l=>t.limit=l),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:t.total,onSizeChange:t.handleSizeChange,onCurrentChange:t.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])]),_:1})])}const ve=Q(ne,[["render",ie],["__scopeId","data-v-80e8572c"]]);export{ve as default};
