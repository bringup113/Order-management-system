import{_ as z,b as E,r as V,c as k,y as S,o as N,e as T,i as w,f as e,w as o,H as L,E as P,I as B,t as D,A as U,n as d,J as I,k as Q,z as q,q as F,s as M,V as R,W as j,g as A,D as G,F as H,G as J,K,L as O}from"./index-518491b2.js";/* empty css                   *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                *//* empty css                     */import{a as W,d as X}from"./visa-d4042f05.js";const Y={name:"VisaList",setup(){const g=E(),a=V(!1),y=V([]),t=V(0),n=k({customerName:"",passportNo:"",visaType:"",issueCountry:"",status:"",pageNum:1,pageSize:10}),p=()=>{a.value=!0,W(n).then(s=>{const{data:_,total:l}=L(s);y.value=_||[],t.value=l||0}).catch(s=>{console.error("获取签证列表失败",s),P.error("获取签证列表失败"),y.value=[],t.value=0}).finally(()=>{a.value=!1})},i=s=>{switch(s){case"valid":return"success";case"expired":return"danger";case"expiring":return"warning";default:return"info"}},m=s=>{switch(s){case"valid":return"有效";case"expired":return"过期";case"expiring":return"即将过期";default:return"未知"}},u=()=>{n.pageNum=1,p()},c=()=>{n.customerName="",n.passportNo="",n.visaType="",n.issueCountry="",n.status="",n.pageNum=1,p()},v=()=>{g.push("/customer/visa/create")},C=s=>{g.push(`/customer/visa/edit/${s.id}`)},f=s=>{g.push(`/customer/passport/detail/${s.passportId}`)},r=s=>{B.confirm("确认删除该签证信息吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{X(s.id).then(()=>{P.success("删除成功"),p()}).catch(_=>{console.error("删除签证失败",_),P.error("删除签证失败")})}).catch(()=>{})},b=s=>{n.pageSize=s,p()},h=s=>{n.pageNum=s,p()};return S(()=>{p()}),{loading:a,visaList:y,total:t,queryParams:n,getStatusType:i,getStatusText:m,handleQuery:u,resetQuery:c,handleCreate:v,handleEdit:C,handleViewPassport:f,handleDelete:r,handleSizeChange:b,handleCurrentChange:h}}},Z={class:"visa-list-container"},$={class:"visa-list-header"},ee={class:"pagination-container"};function ae(g,a,y,t,n,p){const i=D,m=F,u=M,c=R,v=j,C=A,f=U,r=G,b=H,h=J,s=K,_=O;return N(),T("div",Z,[w("div",$,[a[8]||(a[8]=w("h2",null,"签证管理",-1)),e(i,{type:"primary",onClick:t.handleCreate},{default:o(()=>a[7]||(a[7]=[d("新增签证")])),_:1},8,["onClick"])]),e(f,{class:"filter-container"},{default:o(()=>[e(C,{inline:!0,model:t.queryParams,class:"demo-form-inline"},{default:o(()=>[e(u,{label:"客户姓名"},{default:o(()=>[e(m,{modelValue:t.queryParams.customerName,"onUpdate:modelValue":a[0]||(a[0]=l=>t.queryParams.customerName=l),placeholder:"请输入客户姓名",clearable:""},null,8,["modelValue"])]),_:1}),e(u,{label:"护照号码"},{default:o(()=>[e(m,{modelValue:t.queryParams.passportNo,"onUpdate:modelValue":a[1]||(a[1]=l=>t.queryParams.passportNo=l),placeholder:"请输入护照号码",clearable:""},null,8,["modelValue"])]),_:1}),e(u,{label:"签证类型"},{default:o(()=>[e(m,{modelValue:t.queryParams.visaType,"onUpdate:modelValue":a[2]||(a[2]=l=>t.queryParams.visaType=l),placeholder:"请输入签证类型",clearable:""},null,8,["modelValue"])]),_:1}),e(u,{label:"签发国家"},{default:o(()=>[e(m,{modelValue:t.queryParams.issueCountry,"onUpdate:modelValue":a[3]||(a[3]=l=>t.queryParams.issueCountry=l),placeholder:"请输入签发国家",clearable:""},null,8,["modelValue"])]),_:1}),e(u,{label:"状态"},{default:o(()=>[e(v,{modelValue:t.queryParams.status,"onUpdate:modelValue":a[4]||(a[4]=l=>t.queryParams.status=l),placeholder:"请选择状态",clearable:""},{default:o(()=>[e(c,{label:"有效",value:"valid"}),e(c,{label:"过期",value:"expired"}),e(c,{label:"即将过期",value:"expiring"})]),_:1},8,["modelValue"])]),_:1}),e(u,null,{default:o(()=>[e(i,{type:"primary",onClick:t.handleQuery},{default:o(()=>a[9]||(a[9]=[d("查询")])),_:1},8,["onClick"]),e(i,{onClick:t.resetQuery},{default:o(()=>a[10]||(a[10]=[d("重置")])),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1}),e(f,{class:"table-container"},{default:o(()=>[I((N(),Q(h,{data:t.visaList,border:"",style:{width:"100%"}},{default:o(()=>[e(r,{prop:"customerName",label:"客户姓名",width:"120"}),e(r,{prop:"passportNo",label:"护照号码",width:"150"}),e(r,{prop:"visaType",label:"签证类型",width:"120"}),e(r,{prop:"issueCountry",label:"签发国家/地区",width:"150"}),e(r,{prop:"issueDate",label:"签发日期",width:"120"}),e(r,{prop:"expiryDate",label:"有效期至",width:"120"}),e(r,{prop:"entryCount",label:"入境次数",width:"100"},{default:o(l=>[d(q(l.row.entryCount==="single"?"单次":"多次"),1)]),_:1}),e(r,{prop:"status",label:"状态",width:"100"},{default:o(l=>[e(b,{type:t.getStatusType(l.row.status)},{default:o(()=>[d(q(t.getStatusText(l.row.status)),1)]),_:2},1032,["type"])]),_:1}),e(r,{label:"操作",width:"200"},{default:o(l=>[e(i,{size:"small",type:"primary",onClick:x=>t.handleEdit(l.row)},{default:o(()=>a[11]||(a[11]=[d("编辑")])),_:2},1032,["onClick"]),e(i,{size:"small",type:"success",onClick:x=>t.handleViewPassport(l.row)},{default:o(()=>a[12]||(a[12]=[d("查看护照")])),_:2},1032,["onClick"]),e(i,{size:"small",type:"danger",onClick:x=>t.handleDelete(l.row)},{default:o(()=>a[13]||(a[13]=[d("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[_,t.loading]]),w("div",ee,[e(s,{"current-page":t.queryParams.pageNum,"onUpdate:currentPage":a[5]||(a[5]=l=>t.queryParams.pageNum=l),"page-size":t.queryParams.pageSize,"onUpdate:pageSize":a[6]||(a[6]=l=>t.queryParams.pageSize=l),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:t.total,onSizeChange:t.handleSizeChange,onCurrentChange:t.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])]),_:1})])}const me=z(Y,[["render",ae],["__scopeId","data-v-97b7c338"]]);export{me as default};
