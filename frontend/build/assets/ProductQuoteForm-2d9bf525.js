import{_ as w,M as D,b as S,r as c,x as y,c as L,y as R,o as m,e as k,i as C,z as U,f as r,w as a,E as P,A as M,k as E,X as q,Y as x,Z as T,n as F,W as A,s as j,a2 as z,q as W,t as X,g as Y,V as Z}from"./index-518491b2.js";/* empty css                *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css               *//* empty css                  */import{a as G,f as H,h as J}from"./product-50d99a21.js";const K={name:"ProductQuoteForm",setup(){const p=D(),o=S(),b=c(null),e=c(!1),f=c(!1),_=c([]),i=c([]),v=c({}),l=y(()=>p.query.productId),d=y(()=>p.name==="ProductQuoteEdit"),n=L({id:null,productId:l.value||null,supplierId:null,supplierName:"",costPrice:0,remark:""}),g={productId:[{required:!0,message:"请选择产品",trigger:"change"}],supplierId:[{required:!0,message:"请选择供应商",trigger:"change"}],costPrice:[{required:!0,message:"请输入成本价格",trigger:"blur"}]},h=s=>{s?(f.value=!0,setTimeout(()=>{_.value=[{id:1,name:"日本东京5日游"},{id:2,name:"泰国曼谷7日游"},{id:3,name:"法国巴黎8日游"}].filter(u=>u.name.includes(s)),f.value=!1},500)):_.value=[]},I=s=>{e.value=!0,G(s).then(u=>{v.value=u.data}).catch(u=>{console.error("获取产品详情失败",u),P.error("获取产品详情失败")}).finally(()=>{e.value=!1})},t=()=>{i.value=[{id:1,name:"供应商A"},{id:2,name:"供应商B"},{id:3,name:"供应商C"}]},N=s=>{const u=i.value.find(V=>V.id===s);u&&(n.supplierName=u.name)},B=s=>{e.value=!0,setTimeout(()=>{Object.assign(n,{id:1,productId:1,supplierId:2,supplierName:"供应商B",costPrice:1999.99,remark:"这是一个备注"}),e.value=!1},500)},Q=()=>{b.value.validate(s=>{if(s)e.value=!0,(d.value?H(n.id,n):J(n.productId,n)).then(()=>{P.success(d.value?"修改成功":"添加成功"),l.value?o.push(`/product/detail/${l.value}`):o.push("/product/list")}).catch(V=>{console.error(d.value?"修改报价失败":"添加报价失败",V),P.error(d.value?"修改报价失败":"添加报价失败")}).finally(()=>{e.value=!1});else return!1})},O=()=>{l.value?o.push(`/product/detail/${l.value}`):o.push("/product/list")};return R(()=>{t(),l.value&&I(l.value),d.value&&p.params.id&&B(p.params.id)}),{formRef:b,form:n,rules:g,loading:e,productLoading:f,productOptions:_,supplierOptions:i,productId:l,isEdit:d,searchProducts:h,handleSupplierChange:N,submitForm:Q,cancel:O}}},$={class:"product-quote-form-container"},ee={class:"product-quote-form-header"};function oe(p,o,b,e,f,_){const i=Z,v=A,l=j,d=z,n=W,g=X,h=Y,I=M;return m(),k("div",$,[C("div",ee,[C("h2",null,U(e.isEdit?"编辑产品报价":"新增产品报价"),1)]),r(I,{class:"form-container"},{default:a(()=>[r(h,{ref:"formRef",model:e.form,rules:e.rules,"label-width":"120px","label-position":"right"},{default:a(()=>[e.productId?T("",!0):(m(),E(l,{key:0,label:"产品信息"},{default:a(()=>[r(v,{modelValue:e.form.productId,"onUpdate:modelValue":o[0]||(o[0]=t=>e.form.productId=t),placeholder:"请选择产品",filterable:"",remote:"","remote-method":e.searchProducts,loading:e.productLoading},{default:a(()=>[(m(!0),k(q,null,x(e.productOptions,t=>(m(),E(i,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","remote-method","loading"])]),_:1})),r(l,{label:"供应商",prop:"supplierId"},{default:a(()=>[r(v,{modelValue:e.form.supplierId,"onUpdate:modelValue":o[1]||(o[1]=t=>e.form.supplierId=t),placeholder:"请选择供应商",filterable:"",onChange:e.handleSupplierChange},{default:a(()=>[(m(!0),k(q,null,x(e.supplierOptions,t=>(m(),E(i,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1}),r(l,{label:"成本价格",prop:"costPrice"},{default:a(()=>[r(d,{modelValue:e.form.costPrice,"onUpdate:modelValue":o[2]||(o[2]=t=>e.form.costPrice=t),precision:2,step:.1,min:0,style:{width:"200px"}},null,8,["modelValue"])]),_:1}),r(l,{label:"备注",prop:"remark"},{default:a(()=>[r(n,{modelValue:e.form.remark,"onUpdate:modelValue":o[3]||(o[3]=t=>e.form.remark=t),type:"textarea",placeholder:"请输入备注信息",rows:3},null,8,["modelValue"])]),_:1}),r(l,null,{default:a(()=>[r(g,{type:"primary",onClick:e.submitForm,loading:e.loading},{default:a(()=>o[4]||(o[4]=[F("保存")])),_:1},8,["onClick","loading"]),r(g,{onClick:e.cancel},{default:a(()=>o[5]||(o[5]=[F("取消")])),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1})])}const ie=w(K,[["render",oe],["__scopeId","data-v-7b0ceeed"]]);export{ie as default};
