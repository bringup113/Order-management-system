import{_ as V,M as B,b as L,r as E,c as N,y as S,o as g,e as T,i as m,f as e,w as s,J as P,k as I,Q as R,E as b,H as z,I as M,t as A,A as F,L as G,n,z as p,R as H,S as J,T as Q,D as j,F as q,G as K}from"./index-518491b2.js";/* empty css                   *//* empty css                        *//* empty css               *//* empty css                 *//* empty css                *//* empty css                             */import{a as O}from"./passport-f309c118.js";import{g as U,d as W}from"./visa-d4042f05.js";const X={name:"PassportDetail",setup(){const v=B(),o=L(),f=E(!1),t=E(!1),r=N({id:null,name:"",passportNo:"",nationality:"",gender:"",birthDate:"",issueDate:"",expiryDate:"",remark:""}),y=E([]),u=a=>{f.value=!0,O(a).then(d=>{const l=R(d);r.id=l.id,r.name=l.name,r.passportNo=l.passportNo,r.nationality=l.nationality,r.gender=l.gender,r.birthDate=l.birthDate,r.issueDate=l.issueDate,r.expiryDate=l.expiryDate,r.remark=l.remarks}).catch(d=>{console.error("获取护照详情失败",d),b.error("获取护照详情失败")}).finally(()=>{f.value=!1})},i=a=>{t.value=!0,U(a).then(d=>{const l=z(d);console.log("签证列表数据:",l.data),l.data&&l.data.length>0?y.value=l.data.map(_=>({..._,visaType:_.visaType==="æ—…æ¸¸ç­¾è¯"?"旅游签证":_.visaType,issueCountry:_.issueCountry==="ç¾Žå›½"?"美国":_.issueCountry,remarks:_.remarks==="æµ‹è¯•ç­¾è¯"?"测试签证":_.remarks})):y.value=[]}).catch(d=>{console.error("获取签证列表失败",d),b.error("获取签证列表失败")}).finally(()=>{t.value=!1})},D=a=>{switch(a){case"valid":return"success";case"expired":return"danger";case"expiring":return"warning";default:return"info"}},h=a=>{switch(a){case"valid":return"有效";case"expired":return"过期";case"expiring":return"即将过期";default:return"未知"}},k=()=>{o.push(`/customer/passport/edit/${r.id}`)},c=()=>{o.push(`/customer/visa/create?passportId=${r.id}`)},w=a=>{o.push(`/customer/visa/edit/${a.id}`)},x=a=>{M.confirm("确认删除该签证信息吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{W(a.id).then(()=>{b.success("删除成功"),i(r.id)}).catch(d=>{console.error("删除签证失败",d),b.error("删除签证失败")})}).catch(()=>{})},C=()=>{o.push("/customer/passport/list")};return S(()=>{if(v.params.id){const a=v.params.id;u(a),i(a)}}),{loading:f,visaLoading:t,passportInfo:r,visaList:y,getStatusType:D,getStatusText:h,handleEdit:k,handleAddVisa:c,handleEditVisa:w,handleDeleteVisa:x,goBack:C}}},Y={class:"passport-detail-container"},Z={class:"passport-detail-header"},$={class:"header-actions"},ee={class:"visa-list-header"},te={key:0,class:"empty-data"};function ae(v,o,f,t,r,y){const u=A,i=H,D=J,h=F,k=Q,c=j,w=q,x=K,C=G;return g(),T("div",Y,[m("div",Z,[o[2]||(o[2]=m("h2",null,"护照详情",-1)),m("div",$,[e(u,{type:"primary",onClick:t.handleEdit},{default:s(()=>o[0]||(o[0]=[n("编辑")])),_:1},8,["onClick"]),e(u,{onClick:t.goBack},{default:s(()=>o[1]||(o[1]=[n("返回")])),_:1},8,["onClick"])])]),P((g(),I(h,{class:"detail-container"},{default:s(()=>[e(D,{title:"基本信息",column:2,border:""},{default:s(()=>[e(i,{label:"客户姓名"},{default:s(()=>[n(p(t.passportInfo.name),1)]),_:1}),e(i,{label:"护照号码"},{default:s(()=>[n(p(t.passportInfo.passportNo),1)]),_:1}),e(i,{label:"国籍"},{default:s(()=>[n(p(t.passportInfo.nationality),1)]),_:1}),e(i,{label:"性别"},{default:s(()=>[n(p(t.passportInfo.gender==="male"?"男":"女"),1)]),_:1}),e(i,{label:"出生日期"},{default:s(()=>[n(p(t.passportInfo.birthDate),1)]),_:1}),e(i,{label:"签发日期"},{default:s(()=>[n(p(t.passportInfo.issueDate),1)]),_:1}),e(i,{label:"有效期至"},{default:s(()=>[n(p(t.passportInfo.expiryDate),1)]),_:1}),e(i,{label:"备注",span:2},{default:s(()=>[n(p(t.passportInfo.remark||"无"),1)]),_:1})]),_:1})]),_:1})),[[C,t.loading]]),e(h,{class:"visa-list-container"},{default:s(()=>[m("div",ee,[o[4]||(o[4]=m("h3",null,"关联签证信息",-1)),e(u,{type:"primary",size:"small",onClick:t.handleAddVisa},{default:s(()=>o[3]||(o[3]=[n("添加签证")])),_:1},8,["onClick"])]),t.visaList.length===0?(g(),T("div",te,[e(k,{description:"暂无签证信息"})])):(g(),I(x,{key:1,data:t.visaList,border:"",style:{width:"100%"}},{default:s(()=>[e(c,{prop:"visaType",label:"签证类型",width:"120"}),e(c,{prop:"issueCountry",label:"签发国家/地区",width:"150"}),e(c,{prop:"issueDate",label:"签发日期",width:"120"}),e(c,{prop:"expiryDate",label:"有效期至",width:"120"}),e(c,{prop:"entryCount",label:"入境次数",width:"100"},{default:s(a=>[n(p(a.row.entryCount==="single"?"单次":"多次"),1)]),_:1}),e(c,{prop:"status",label:"状态",width:"100"},{default:s(a=>[e(w,{type:t.getStatusType(a.row.status)},{default:s(()=>[n(p(t.getStatusText(a.row.status)),1)]),_:2},1032,["type"])]),_:1}),e(c,{label:"操作",width:"150"},{default:s(a=>[e(u,{size:"small",type:"primary",onClick:d=>t.handleEditVisa(a.row)},{default:s(()=>o[5]||(o[5]=[n("编辑")])),_:2},1032,["onClick"]),e(u,{size:"small",type:"danger",onClick:d=>t.handleDeleteVisa(a.row)},{default:s(()=>o[6]||(o[6]=[n("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]))]),_:1})])}const ue=V(X,[["render",ae],["__scopeId","data-v-b17ef294"]]);export{ue as default};
