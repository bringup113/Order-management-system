import{_ as R,b as M,r as _,c as P,y as T,o as k,e as L,i as E,f as e,w as o,H as A,E as D,t as B,A as U,n as c,J as Y,k as I,z as F,q as j,s as q,V as G,W as H,P as J,g as K,D as W,F as Q,$ as X,G as Z,K as $,L as ee}from"./index-518491b2.js";/* empty css                   *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                *//* empty css                     *//* empty css                       */import{g as ae,d as te}from"./order-8bc548e3.js";const re={name:"OrderList",setup(){const f=M(),r=_(!1),g=_([]),t=_(0),u=_(1),h=_(10),n=P({orderNo:"",customerName:"",orderStatus:"",paymentStatus:"",dateRange:[]}),s=async()=>{r.value=!0;try{const a={page:u.value,limit:h.value,orderNo:n.orderNo,customerName:n.customerName,orderStatus:n.orderStatus,paymentStatus:n.paymentStatus};n.dateRange&&n.dateRange.length===2&&(a.startDate=n.dateRange[0],a.endDate=n.dateRange[1]);const m=await ae(a),{data:x,total:z}=A(m);g.value=x,t.value=z}catch(a){console.error("获取订单列表失败:",a),D.error("获取订单列表失败"),g.value=[{id:1,orderNo:"ORD20230001",passportName:"张三",agentName:"北京旅行社",totalAmount:5e3,orderDate:"2023-01-15",orderStatus:"pending",paymentStatus:"unpaid"},{id:2,orderNo:"ORD20230002",passportName:"李四",agentName:"上海旅游公司",totalAmount:8e3,orderDate:"2023-01-20",orderStatus:"processing",paymentStatus:"partial"},{id:3,orderNo:"ORD20230003",passportName:"王五",agentName:"广州旅游集团",totalAmount:12e3,orderDate:"2023-01-25",orderStatus:"completed",paymentStatus:"paid"}],t.value=g.value.length}finally{r.value=!1}},p=()=>{u.value=1,s()},i=()=>{Object.keys(n).forEach(a=>{a==="dateRange"?n[a]=[]:n[a]=""}),u.value=1,s()},y=a=>{h.value=a,s()},v=a=>{u.value=a,s()},C=a=>({pending:"待处理",processing:"处理中",completed:"已完成",cancelled:"已取消"})[a]||a,S=a=>({pending:"warning",processing:"primary",completed:"success",cancelled:"danger"})[a]||"",d=a=>({unpaid:"未支付",partial:"部分支付",paid:"已支付"})[a]||a,b=a=>({unpaid:"danger",partial:"warning",paid:"success"})[a]||"",w=a=>`¥ ${parseFloat(a).toFixed(2)}`,O=a=>{f.push({name:"OrderDetail",params:{id:a.id}})},N=a=>{f.push({name:"OrderEdit",params:{id:a.id}})},V=async a=>{try{await te(a),D.success("订单删除成功"),s()}catch(m){console.error("删除订单失败:",m),D.error("删除订单失败")}},l=()=>{f.push({name:"OrderCreate"})};return T(()=>{s()}),{loading:r,orderList:g,total:t,currentPage:u,pageSize:h,searchForm:n,handleSearch:p,resetSearch:i,handleSizeChange:y,handleCurrentChange:v,getOrderStatusText:C,getOrderStatusType:S,getPaymentStatusText:d,getPaymentStatusType:b,formatCurrency:w,handleViewOrder:O,handleEditOrder:N,handleDeleteOrder:V,handleCreateOrder:l}}},oe={class:"order-list-container"},le={class:"page-header"},ne={class:"pagination-container"};function de(f,r,g,t,u,h){const n=B,s=j,p=q,i=G,y=H,v=J,C=K,S=U,d=W,b=Q,w=X,O=Z,N=$,V=ee;return k(),L("div",oe,[E("div",le,[r[6]||(r[6]=E("h1",null,"订单管理",-1)),e(n,{type:"primary",onClick:t.handleCreateOrder},{default:o(()=>r[5]||(r[5]=[c("新建订单")])),_:1},8,["onClick"])]),e(S,{class:"search-card"},{default:o(()=>[e(C,{model:t.searchForm,"label-width":"100px",inline:""},{default:o(()=>[e(p,{label:"订单编号"},{default:o(()=>[e(s,{modelValue:t.searchForm.orderNo,"onUpdate:modelValue":r[0]||(r[0]=l=>t.searchForm.orderNo=l),placeholder:"请输入订单编号",clearable:""},null,8,["modelValue"])]),_:1}),e(p,{label:"客户姓名"},{default:o(()=>[e(s,{modelValue:t.searchForm.customerName,"onUpdate:modelValue":r[1]||(r[1]=l=>t.searchForm.customerName=l),placeholder:"请输入客户姓名",clearable:""},null,8,["modelValue"])]),_:1}),e(p,{label:"订单状态"},{default:o(()=>[e(y,{modelValue:t.searchForm.orderStatus,"onUpdate:modelValue":r[2]||(r[2]=l=>t.searchForm.orderStatus=l),placeholder:"请选择订单状态",clearable:""},{default:o(()=>[e(i,{label:"待处理",value:"pending"}),e(i,{label:"处理中",value:"processing"}),e(i,{label:"已完成",value:"completed"}),e(i,{label:"已取消",value:"cancelled"})]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"支付状态"},{default:o(()=>[e(y,{modelValue:t.searchForm.paymentStatus,"onUpdate:modelValue":r[3]||(r[3]=l=>t.searchForm.paymentStatus=l),placeholder:"请选择支付状态",clearable:""},{default:o(()=>[e(i,{label:"未支付",value:"unpaid"}),e(i,{label:"部分支付",value:"partial"}),e(i,{label:"已支付",value:"paid"})]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"下单日期"},{default:o(()=>[e(v,{modelValue:t.searchForm.dateRange,"onUpdate:modelValue":r[4]||(r[4]=l=>t.searchForm.dateRange=l),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),e(p,null,{default:o(()=>[e(n,{type:"primary",onClick:t.handleSearch},{default:o(()=>r[7]||(r[7]=[c("搜索")])),_:1},8,["onClick"]),e(n,{onClick:t.resetSearch},{default:o(()=>r[8]||(r[8]=[c("重置")])),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1}),e(S,{class:"list-card"},{default:o(()=>[Y((k(),I(O,{data:t.orderList,border:"",style:{width:"100%"}},{default:o(()=>[e(d,{prop:"orderNo",label:"订单编号",width:"180"}),e(d,{prop:"passportName",label:"客户姓名",width:"120"}),e(d,{prop:"agentName",label:"代理商",width:"150"}),e(d,{prop:"totalAmount",label:"订单金额",width:"120"},{default:o(l=>[c(F(t.formatCurrency(l.row.totalAmount)),1)]),_:1}),e(d,{prop:"orderDate",label:"下单日期",width:"120"}),e(d,{prop:"orderStatus",label:"订单状态",width:"100"},{default:o(l=>[e(b,{type:t.getOrderStatusType(l.row.orderStatus)},{default:o(()=>[c(F(t.getOrderStatusText(l.row.orderStatus)),1)]),_:2},1032,["type"])]),_:1}),e(d,{prop:"paymentStatus",label:"支付状态",width:"100"},{default:o(l=>[e(b,{type:t.getPaymentStatusType(l.row.paymentStatus)},{default:o(()=>[c(F(t.getPaymentStatusText(l.row.paymentStatus)),1)]),_:2},1032,["type"])]),_:1}),e(d,{label:"操作",fixed:"right",width:"200"},{default:o(l=>[e(n,{size:"small",onClick:a=>t.handleViewOrder(l.row)},{default:o(()=>r[9]||(r[9]=[c("查看")])),_:2},1032,["onClick"]),e(n,{size:"small",type:"primary",onClick:a=>t.handleEditOrder(l.row)},{default:o(()=>r[10]||(r[10]=[c("编辑")])),_:2},1032,["onClick"]),e(w,{title:"确定要删除此订单吗？",onConfirm:a=>t.handleDeleteOrder(l.row.id)},{reference:o(()=>[e(n,{size:"small",type:"danger"},{default:o(()=>r[11]||(r[11]=[c("删除")])),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[V,t.loading]]),E("div",ne,[e(N,{background:"",layout:"total, sizes, prev, pager, next, jumper",total:t.total,"page-size":t.pageSize,"current-page":t.currentPage,onSizeChange:t.handleSizeChange,onCurrentChange:t.handleCurrentChange},null,8,["total","page-size","current-page","onSizeChange","onCurrentChange"])])]),_:1})])}const Se=R(re,[["render",de],["__scopeId","data-v-e33b7bcc"]]);export{Se as default};
